---
title: "ENTREGA 1"
date: today
date-format: "DD MMMM, YYYY"
author: 
  Mathias
abstract:
    Métodos Estadísticos para la Regresión y la Clasificación
abstractspacing: double
appendix: false
fontfamily: libertine
monofont: inconsolata
monofontoptions: scaled=.95
fontsize: 12pt
geometry: 
  - top=2cm
  - bottom=2cm
  - left=2cm
  - right=2cm
urlcolor: darkblue
highlight-style: arrow
format: 
    pdf:
      toc: true
      number-sections: true
      colorlinks: true
---

# Ejercicio 5: Estudio farmaceutico

## Construir un diagrama de tallos y hojas (extendido) para estos tiempos.

| Stem | Leaf |
|------|------|
| 0    | 9    |
| 1    | 0 0 1 1 2 2 3 3 4 5 5 5 6 7 8 8 8 9 9 9 |
| 2    | 0 0 1 1 2 3 4 6 |

## Construir una tabla de frecuencias y densidades para estos tiempos.

```{r}
# Cargar los tiempos
tiempos <- c(15, 18, 19, 21, 23, 26, 17, 18, 24, 20, 13, 10, 16, 11, 9,
             12, 14, 10, 19, 13, 20, 15, 11, 18, 15, 21, 12, 19, 18, 22)

# Crear los intervalos de 5 unidades
intervalos <- seq(0, 30, by = 5) # avanza de 5 en 5 de 0 a 30

# Tabla de frecuencias
tabla_frecuencias <- cut(tiempos, breaks = intervalos, right = FALSE) # Divide los 
# datos en intervalos ("bins"), para eso se usa cut
frecuencia <- table(tabla_frecuencias) # Crea una tabla que tiene el conteo de cada
# categoria, en este caso intervalos

# Densidades (frecuencia / tamaño del intervalo)
densidad <- prop.table(frecuencia) # Partiendo de la tabla de frecuencias esta 
# funcion se usa para calcular la densidad de frecuencias

# Mostrar la tabla de frecuencias y densidades
tabla_resultado <- data.frame(Intervalo = names(frecuencia),
    Frecuencia = as.vector(frecuencia),
    Densidad = as.vector(densidad))
print(tabla_resultado)

```


## Dibujar un histograma para estos tiempos dividiendo el intervalo [0, 30] en 6 intervalos de longitud 5 en escala frecuencia y en escala densidad.

```{r}

library(ggplot2)

# Crear el dataframe para ggplot
df_tiempos <- data.frame(tiempos) # vector a dataframe

# Histograma en escala de frecuencia
ggplot(df_tiempos, aes(x = tiempos)) +
  geom_histogram(breaks = intervalos, # intervalos para separar
                  fill = "lightblue", # relleno
                  color = "black") + # borde
  labs(title = "Histograma de Frecuencia", x = "Tiempos", y = "Frecuencia") +
  theme_minimal()

# Histograma en escala de densidad
ggplot(df_tiempos, aes(x = tiempos)) +
  geom_histogram(aes(y = ..density..),
   breaks = intervalos,
   fill = "lightgreen", # relleno
   color = "black") + # borde
  geom_density() + # agrega capa de densidad
  labs(title = "Histograma de Densidad", x = "Tiempos", y = "Densidad") + # Se calcula la densidad
  theme_minimal()

```

## Ejercicio 7: Tablas de contingencia II

|         | Café | Té | Refresco |
|---------|------|----|----------|
| Hombres | 50 | 30 | 20 |
| Mujeres | 40 | 45 | 15 |

Tabla 1: Tabla de contingencia de preferencias de bebidas por género.

La hipótesis a probar es la siguiente:

Hipótesis nula $H_0$: No existe dependencia entre el género y la preferencia de bebida.
Hipótesis alternativa $H_1$: Existe dependencia entre el género y la preferencia de bebida.

```{r}
# Datos observados
observados <- matrix(c(50, 30, 20, 40, 45, 15), nrow = 2, byrow = TRUE)

# Realizar el test chi-cuadrado
test_chi2 <- chisq.test(observados)

# Resultado del test
test_chi2

```

No hay suficiente evidencia para rechazar la $H_0$.

## Cálculo de las frecuencias esperadas:

Para calcular las frecuencias esperadas, usamos la fórmula:

$$
E_{ij} = \frac{F_{i\cdot} \cdot F_{\cdot j}}{N}
$$

Donde:

- $( E_{ij} )$ es la frecuencia esperada para la celda $( i,j )$.
- $( F_{i\cdot} )$ es la suma de la fila $( i )$.
- $( F_{\cdot j} )$ es la suma de la columna $( j )$.
- $( N )$ es el total de observaciones.

### Sumas de filas:

- Hombres: \( 50 + 30 + 20 = 100 \)
- Mujeres: \( 40 + 45 + 15 = 100 \)

### Sumas de columnas:

- Café: $( 50 + 40 = 90 )$
- Té: $( 30 + 45 = 75 )$
- Refresco: $( 20 + 15 = 35 )$

### Total de observaciones:

$$
N = 100 + 100 = 200
$$

### Cálculo de las frecuencias esperadas:

- Para los hombres y café:

$$
E_{11} = \frac{100 \cdot 90}{200} = 45
$$

- Para los hombres y té:

$$
E_{12} = \frac{100 \cdot 75}{200} = 37.5
$$

- Para los hombres y refresco:

$$
E_{13} = \frac{100 \cdot 35}{200} = 17.5
$$

- Para las mujeres y café:

$$
E_{21} = \frac{100 \cdot 90}{200} = 45
$$

- Para las mujeres y té:

$$
E_{22} = \frac{100 \cdot 75}{200} = 37.5
$$

- Para las mujeres y refresco:

$$
E_{23} = \frac{100 \cdot 35}{200} = 17.5
$$

## Cálculo del estadístico \(\chi^2\):

El estadístico de prueba \(\chi^2\) se calcula usando la fórmula:

$$
\chi^2 = \sum_{i=1}^{r} \sum_{j=1}^{c} \frac{(O_{ij} - E_{ij})^2}{E_{ij}}
$$

Donde \(O_{ij}\) son las frecuencias observadas y \(E_{ij}\) son las frecuencias esperadas.

$$
\chi^2 = \frac{(50 - 45)^2}{45} + \frac{(30 - 37.5)^2}{37.5} + \frac{(20 - 17.5)^2}{17.5} + \frac{(40 - 45)^2}{45} + \frac{(45 - 37.5)^2}{37.5} + \frac{(15 - 17.5)^2}{17.5}
$$

Calculamos cada término:

$$
\chi^2 = \frac{25}{45} + \frac{56.25}{37.5} + \frac{6.25}{17.5} + \frac{25}{45} + \frac{56.25}{37.5} + \frac{6.25}{17.5}
$$

Simplificamos:

$$
\chi^2 = \frac{25}{45} + \frac{56.25}{37.5} + \frac{6.25}{17.5} + \frac{25}{45} + \frac{56.25}{37.5} + \frac{6.25}{17.5} = 0.556 + 1.5 + 0.357 + 0.556 + 1.5 + 0.357 = 4.826
$$

### Grados de libertad:

Los grados de libertad se calculan como:

$$
\text{gl} = (r - 1)(c - 1) = (2 - 1)(3 - 1) = 2
$$

### Comparación con el valor crítico:

El valor crítico de \(\chi^2\) para un nivel de significancia \(\alpha = 0.05\) y 2 grados de libertad es aproximadamente 5.99.

Como el estadístico calculado \(\chi^2 = 4.826\) es menor que 5.99, no rechazamos la hipótesis nula.


Ejercicio 4: Descomposición de la varianza II

    Esperanza condicional E(X3∣Y)E(X3∣Y):
        Usando la densidad conjunta f(x,y)=2f(x,y)=2 para 0<x<y<10<x<y<1, se calcula:
        E(X3∣Y=y)=∫0y2x3 dx=y42
        E(X3∣Y=y)=∫0y​2x3dx=2y4​
    Descomposición de la varianza de YY:
        Similar al ejercicio anterior, se descompone la varianza de YY usando la fórmula de la varianza total.

Ejercicio 7: Normal multivariada

    Distribución de Y=X1+2X2−3X3Y=X1​+2X2​−3X3​:
        Se trata de una combinación lineal de normales, por lo que Y∼N(μY,σY2)Y∼N(μY​,σY2​), donde μYμY​ y σY2σY2​ se calculan en función de la media y covarianza de XX.

    Independencia de X1X1​ y otra variable:
        Se encuentra un vector u=(u1,u2)u=(u1​,u2​) tal que X1X1​ y X1−(u1X1+u2X2)X1​−(u1​X1​+u2​X2​) sean independientes.