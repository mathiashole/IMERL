---
title: "ENTREGA 1"
date: today
date-format: "DD MMMM, YYYY"
author: 
  Mathias
abstract:
    Métodos Estadísticos para la Regresión y la Clasificación
abstractspacing: double
appendix: false
fontfamily: libertine
monofont: inconsolata
monofontoptions: scaled=.95
fontsize: 12pt
geometry: 
  - top=2cm
  - bottom=2cm
  - left=2cm
  - right=2cm
urlcolor: darkblue
highlight-style: arrow
format: 
    pdf:
      toc: true
      number-sections: true
      colorlinks: true
---

## Ejercicio 5: Estudio farmaceutico

### 1.5.1. Construir un diagrama de tallos y hojas (extendido) para estos tiempos.

| Stem | Leaf |
|------|------|
| 0    | 9    |
| 1    | 0 0 1 1 2 2 3 3 4 5 5 5 6 7 8 8 8 9 9 9 |
| 2    | 0 0 1 1 2 3 4 6 |

### 1.5.2. Construir una tabla de frecuencias y densidades para estos tiempos.

```{r}
# Cargar los datos
tiempos <- c(15, 18, 19, 21, 23, 26, 17, 18, 24, 20, 13, 10, 16, 11, 9,
             12, 14, 10, 19, 13, 20, 15, 11, 18, 15, 21, 12, 19, 18, 22)

# Crear los intervalos de 5 unidades
intervalos <- seq(0, 30, by = 5)

# Tabla de frecuencias
tabla_frecuencias <- cut(tiempos, breaks = intervalos, right = FALSE)
frecuencia <- table(tabla_frecuencias)

# Densidades (frecuencia / tamaño del intervalo)
densidad <- prop.table(frecuencia) / 5

# Mostrar la tabla de frecuencias y densidades
tabla_resultado <- data.frame(Intervalo = names(frecuencia),
    Frecuencia = as.vector(frecuencia),
    Densidad = as.vector(densidad))
print(tabla_resultado)

```


### 1.5.3. Dibujar un histograma para estos tiempos dividiendo el intervalo [0, 30] en 6 interva-
los de longitud 5 en escala frecuencia y en escala densidad.

```{r}

library(ggplot2)

# Crear el dataframe para ggplot
df_tiempos <- data.frame(tiempos)

# Histograma en escala de frecuencia
ggplot(df_tiempos, aes(x = tiempos)) +
  geom_histogram(breaks = intervalos, fill = "lightblue", color = "black", closed = "left") +
  labs(title = "Histograma de Frecuencia", x = "Tiempos", y = "Frecuencia") +
  theme_minimal()

# Histograma en escala de densidad
ggplot(df_tiempos, aes(x = tiempos)) +
  geom_histogram(aes(y = ..density..), breaks = intervalos, fill = "lightgreen", color = "black", closed = "left") +
  labs(title = "Histograma de Densidad", x = "Tiempos", y = "Densidad") +
  theme_minimal()

```

## Ejercicio 7: Tablas de contingencia II

|         | Café | Té | Refresco |
|---------|------|----|----------|
| Hombres | 50 | 30 | 20 |
| Mujeres | 40 | 45 | 15 |
 

Ejercicio 4: Descomposición de la varianza II

    Esperanza condicional E(X3∣Y)E(X3∣Y):
        Usando la densidad conjunta f(x,y)=2f(x,y)=2 para 0<x<y<10<x<y<1, se calcula:
        E(X3∣Y=y)=∫0y2x3 dx=y42
        E(X3∣Y=y)=∫0y​2x3dx=2y4​
    Descomposición de la varianza de YY:
        Similar al ejercicio anterior, se descompone la varianza de YY usando la fórmula de la varianza total.

Ejercicio 7: Normal multivariada

    Distribución de Y=X1+2X2−3X3Y=X1​+2X2​−3X3​:
        Se trata de una combinación lineal de normales, por lo que Y∼N(μY,σY2)Y∼N(μY​,σY2​), donde μYμY​ y σY2σY2​ se calculan en función de la media y covarianza de XX.

    Independencia de X1X1​ y otra variable:
        Se encuentra un vector u=(u1,u2)u=(u1​,u2​) tal que X1X1​ y X1−(u1X1+u2X2)X1​−(u1​X1​+u2​X2​) sean independientes.